{% extends 'base.html.twig' %}

{% block title %}Pré-Cadastros{% endblock %}

{% block body %}
<div class="container mt-4">
    <h2 class="mb-3">Lista de Pré-Cadastros</h2>

    <a href="{{ path('pre_cadastro_new') }}" class="btn btn-success mb-3">Novo Pré-Cadastro</a>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Nome</th>
                <th>CPF/CNPJ</th>
                <th>Registrado</th>
                <th>Status do Contrato</th>
                <th>Criado em</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for preCadastro in pre_cadastros %}
                <tr>
                    <td>{{ preCadastro.nomeCliente }}</td>
                    <td>{{ preCadastro.cpf }}</td>
                    <td>
                        {% if preCadastro.cliente %}
                            <a href="{{ path('cliente_show', {id: preCadastro.cliente.id}) }}" class="text-decoration-none">
                                <span class="badge bg-success">Registrado</span>
                            </a>
                        {% else %}
                            <span class="badge bg-secondary">Não registrado</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if preCadastro.statusContrato %}
                            <span class="badge 
                                {% if preCadastro.statusContrato == 'PENDENTE' %}bg-warning{% 
                                elseif preCadastro.statusContrato == 'EM_ANDAMENTO' %}bg-info{% 
                                elseif preCadastro.statusContrato == 'FINALIZADO' %}bg-success{% 
                                elseif preCadastro.statusContrato == 'CANCELADO' %}bg-danger{% 
                                endif %}">
                                {{ preCadastro.statusContrato == 'PENDENTE' ? 'Pendente' : (
                                   preCadastro.statusContrato == 'EM_ANDAMENTO' ? 'Em Andamento' : (
                                   preCadastro.statusContrato == 'FINALIZADO' ? 'Finalizado' : (
                                   preCadastro.statusContrato == 'CANCELADO' ? 'Cancelado' : preCadastro.statusContrato
                                ))) }}
                            </span>
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>
                        {% if preCadastro.criadoAt %}
                            {{ preCadastro.criadoAt|date('d/m/Y H:i') }}
                        {% else %}
                            -
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ path('pre_cadastro_show', {id: preCadastro.id}) }}" class="btn btn-sm btn-info">Ver detalhes</a>
                        <a href="{{ path('cliente_from_pre_cadastro', {id: preCadastro.id}) }}" class="btn btn-sm btn-warning">Cadastrar Cliente</a>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="6" class="text-center">Nenhum pré-cadastro encontrado.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
